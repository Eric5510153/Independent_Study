
@using System.Data;

@model System.Data.DataTable
@{
    ViewBag.Title = "警察單位資訊";
}
@section css{

        <style>
            #addPolice {
                display: none;
            }
        </style>
    }

    <div class="mt-3">
        <div><h2><strong>警察單位資訊</strong></h2></div>
        <div class="form-1 mt-1 float-right">
            <select class="county light-table-filter form-control " name="" id="" type="text" data-table="table"></select>
            <select class="district light-table-filter form-control  mt-2 " name="" id="" type="text" data-table="table"></select>
        </div>
    </div>

    @if (Session["adm"] != null)
    {

        <p class="mt-3 ">
            <button class="btn btn-success" id="showAddForm">
               &nbsp 建立資訊&nbsp(管理員)
            </button>
        </p>


    }
    <div class="well" id="addPolice">
        @Html.Action("Create")
    </div>


    <table class="table-title" width="100%" style="table-layout:fixed">

        <tr>
            <th>
                警察單位名稱

            </th>
            <th>
                縣市

            </th>
            <th>
                鄉、鎮、市、區

            </th>
            <th>
                地址

            </th>
            <th></th>

        </tr>


    </table>
    <table class="table" width="100%" style="table-layout:fixed">



        @foreach (DataRow row in Model.Rows)
        {
            <tr>
                <td>@row[1]</td>

                <td>@row[2]</td>
                <td>@row[3]</td>
                <td>@row[4]</td>





                <td>
                    <button type="button" id="@row[0]" class="btn btn-primary" data-toggle="modal" data-target="#ShowDetailModal" onclick="getDetailData(event)">
                        詳細內容
                    </button>
                    @if (Session["adm"] != null)
                    {
                    <div class="mt-1">
                        @Html.ActionLink(" Edit (管理員)", "Edit", new { id = row["PoliceID"] }, new { @class = "btn btn-warning btn-sm" })
                        @Html.ActionLink("Delete (管理員)", "Delete", new { id = row["PoliceID"] }, new { @class = "btn btn-danger btn-sm" })
                    </div>
                    }
                 </td>
            </tr>


        }

    </table>

    <script src="/dk-tw-citySelector.js"></script>
    <script>
        $(function () {
            $('.form-1').dk_tw_citySelector('.county', '.district', '.zipcode');

        });
    </script>

    <script>
        (function (document) {
            'use strict';

            // 建立 LightTableFilter
            var LightTableFilter = (function (Arr) {

                var _input;

                // 資料輸入事件處理函數
                function _onInputEvent(e) {
                    _input = e.target;
                    var tables = document.getElementsByClassName(_input.getAttribute('data-table'));
                    Arr.forEach.call(tables, function (table) {
                        Arr.forEach.call(table.tBodies, function (tbody) {
                            Arr.forEach.call(tbody.rows, _filter);
                        });
                    });
                }

                // 資料篩選函數，顯示包含關鍵字的列，其餘隱藏
                function _filter(row) {
                    var text = row.textContent.toLowerCase(), val = _input.value.toLowerCase();
                    row.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';
                }

                return {
                    // 初始化函數
                    init: function () {
                        var inputs = document.getElementsByClassName('light-table-filter');
                        Arr.forEach.call(inputs, function (input) {
                            input.oninput = _onInputEvent;
                        });
                    }
                };
            })(Array.prototype);

            // 網頁載入完成後，啟動 LightTableFilter
            document.addEventListener('readystatechange', function () {
                if (document.readyState === 'complete') {
                    LightTableFilter.init();
                }
            });

        })(document);

    </script>


    <div class="modal fade" id="ShowDetailModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel"></h4>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" data-dismiss="modal">
                         關閉
                    </button>

                </div>
            </div>
        </div>
    </div>
    <hr style="border: 1px solid #ADFEDC " />
    <div>
        @Html.ActionLink("返回災害事故資訊列表", "Index", "Disaster_Accident")
    </div>
    @section scripts{
        <script>

            function getDetailData(evt) {
                $('#ShowDetailModal .modal-body').load("/Police/Details/" + evt.target.id);
                //'#ShowDetailModal .modal-body'  注意需要空格
            }


            $(function () {
                $('[data-toggle="tooltip"]').tooltip()
            })
            $('#showAddForm').click(function () {

                $('#addPolice').fadeToggle(800);
            });

        </script>


    }

@*<table class="table" width="100%" style="table-layout:fixed">

    <tr>
        <th>
            警察單位名稱

        </th>
        <th>
            縣市

        </th>
        <th>
            鄉、鎮、市、區

        </th>
        <th>
            地址

        </th>
        <th></th>

    </tr>


</table>
<table class="table" width="100%" style="table-layout:fixed">



    @foreach (DataRow row in Model.Rows)
    {
        <tr>
            <td>@row[1]</td>

            <td>@row[2]</td>
            <td>@row[3]</td>
            <td>@row[4]</td>





            <td>
            </td>
        </tr>


    }

</table>*@