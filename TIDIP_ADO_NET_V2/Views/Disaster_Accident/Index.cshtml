@model IEnumerable<TIDIP_ADO_NET_V2.Models.Disaster_Accident>


@{
    ViewBag.Title = "災害事故資訊";
}

@section css{

    <style>
        #addDisaster_Accident {
            display: none;
        }
    </style>

}
    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>


    <script src="/dk-tw-citySelector.js"></script>
    <script>
        $(function () {
            $('.form-1').dk_tw_citySelector('.county', '.district');

        });
    </script>
<div class="mt-3">
    <div><h2><strong>災害事故資訊</strong></h2></div>
    <div class="form-1 mt-1 float-right">
        <select class="county light-table-filter form-control " name="" id="" type="text" data-table="table"></select>
        <select class="district light-table-filter form-control  mt-2 " name="" id="" type="text" data-table="table"></select>
    </div>
</div>

@if (Session["mb"] != null)
{
    <p class="mt-3 ">
        <button class="btn btn-success" id="showAddForm">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
            </svg>&nbsp 建立資訊
        </button>
    </p>
}
<div class="well" id="addDisaster_Accident">
    @Html.Action("Create")
</div>


@*<p>
        @Html.ActionLink("新增", "Create", null, new { })
    </p>*@
@*<div>
    <select type="text" class="light-table-filter form-control" data-table="table">
        <option value="">請選擇</option>
        <option value="高雄市">高雄市</option>
        <option value="台中市">台中市</option>
        <option value="台北市">台北市</option>
        <option value="屏東市">屏東市</option>
    </select>
        </div>*@


<table class="table-title" width="100%" style="table-layout:fixed">
    <tr>

        <th>
            資訊建立時間
            @*@Html.DisplayNameFor(model => model.DACreatedDate)*@
        </th>
        <th>
            災害事故縣市
            @*@Html.DisplayNameFor(model => model.County_City)*@
        </th>
        <th>
            鄉、鎮、市、區
            @*@Html.DisplayNameFor(model => model.Area)*@
        </th>
        <th>
            災害事故位置
            @*@Html.DisplayNameFor(model => model.DALocation)*@
        </th>
        <th>
            災害事故類型
            @*@Html.DisplayNameFor(model => model.DAMessage)*@
        </th>


        <!--<th>
            建立此資訊會員-->
        @*@Html.DisplayNameFor(model => model.MbIdentity)*@
        <!--</th>-->
        <!--<th>-->
        @*@Html.DisplayNameFor(model => model.Members.MbName)*@
        <!--</th>-->
        <th></th>
    </tr>
</table>
<table class="table table-hover_2" width="100%" style="table-layout:fixed">

    @foreach (var item in Model)
    {


        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.DACreatedDate)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.County_City)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Area)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DALocation)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Disaster_Accident_Type.DATypeName)
            </td>
            @*<td>
                    @Html.DisplayFor(modelItem => item.MbIdentity)
                </td>*@


            <td>
                @*@Html.ActionLink("Edit", "Edit", new { id = item.DAID }) |
                    @Html.ActionLink("Details", "Details", new { id = item.DAID }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.DAID })*@

                <button type="button" id="@item.DAID" class="btn btn-primary" data-toggle="modal" data-target="#ShowDetailModal" onclick="getDetailData(event)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-task" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M2 2.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5H2zM3 3H2v1h1V3z" />
                        <path d="M5 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM5.5 7a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 4a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9z" />
                        <path fill-rule="evenodd" d="M1.5 7a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V7zM2 7h1v1H2V7zm0 3.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5H2zm1 .5H2v1h1v-1z" />
                    </svg>&nbsp;詳細內容
                </button>

                <!-- 管理員功能-->
                @if (Session["adm"] != null)
                {
                    @Html.ActionLink(" Delete (管理員)", "Delete", new { id = item.DAID }, new { @class = "btn btn-danger btn-sm" })
                }
            </td>
        </tr>



    }


</table>

<script>
    (function (document) {
        'use strict';

        // 建立 LightTableFilter
        var LightTableFilter = (function (Arr) {

            var _input;

            // 資料輸入事件處理函數
            function _onInputEvent(e) {
                _input = e.target;
                var tables = document.getElementsByClassName(_input.getAttribute('data-table'));
                Arr.forEach.call(tables, function (table) {
                    Arr.forEach.call(table.tBodies, function (tbody) {
                        Arr.forEach.call(tbody.rows, _filter);
                    });
                });
            }

            // 資料篩選函數，顯示包含關鍵字的列，其餘隱藏
            function _filter(row) {
                var text = row.textContent.toLowerCase(), val = _input.value.toLowerCase();
                row.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';
            }

            return {
                // 初始化函數
                init: function () {
                    var inputs = document.getElementsByClassName('light-table-filter');
                    Arr.forEach.call(inputs, function (input) {
                        input.oninput = _onInputEvent;
                    });
                }
            };
        })(Array.prototype);

        // 網頁載入完成後，啟動 LightTableFilter
        document.addEventListener('readystatechange', function () {
            if (document.readyState === 'complete') {
                LightTableFilter.init();
            }
        });

    })(document);
</script>

<div class="modal fade" id="ShowDetailModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel"></h4>
            </div>
            <div class="modal-body">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-info" data-dismiss="modal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                    </svg> 關閉
                </button>

            </div>
        </div>
    </div>
</div>

@section scripts{
    <script>

        function getDetailData(evt) {
            $('#ShowDetailModal .modal-body').load("/Disaster_Accident/Details/" + evt.target.id);
            //'#ShowDetailModal .modal-body'  注意需要空格
        }

        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
        $('#showAddForm').click(function () {

            $('#addDisaster_Accident').fadeToggle(800);
        });

    </script>


}

